apiVersion: batch/v1
kind: Job
metadata:
  name: lstm-training
spec:
  backoffLimit: 4 
  template:
    spec:
      containers:
        - name: training
          image: docker.io/kovaleskilab/ml_basic:v1
          resources:
            limits:
              nvidia.com/gpu: 1
              memory: 16G
              cpu: 4
            requests:
              nvidia.com/gpu: 1
              memory: 16G
              cpu: 4
          volumeMounts:
            - name: meep-dataset
              mountPath: /develop/data
            - name: output-volume
              mountPath: /develop/results
          command: ["python"]
          args: ["driver.py", "--config", "config.yaml"]
      volumes:
        - name: meep-dataset
          persistentVolumeClaim:
            claimName: meep-dataset-central-rbd
        - name: results-volume
          persistentVolumeClaim:
            claimName: training-results
      restartPolicy: Never